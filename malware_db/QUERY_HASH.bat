@echo off
REM Quick malware hash check with MalwareBazaar API
REM Usage: QUERY_HASH.bat <hash_value>

setlocal

if "%~1"=="" (
    echo.
    echo ====================================================================
    echo MALWARE HASH QUERY - Quick Reference
    echo ====================================================================
    echo.
    echo Usage:
    echo   QUERY_HASH.bat ^<hash_value^> [--online]
    echo.
    echo Examples:
    echo   QUERY_HASH.bat 44d88612fea8a8f36de82e1278abb02f
    echo   QUERY_HASH.bat 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d --online
    echo.
    echo Options:
    echo   --online    Query MalwareBazaar API for unknown hashes
    echo.
    echo Common Test Hashes:
    echo   EICAR MD5:    44d88612fea8a8f36de82e1278abb02f
    echo   EICAR SHA256: 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
    echo.
    echo API Key: f5b289bbb89ad8a3483fa3548e69d43a7751e16189a2caff
    echo.
    pause
    exit /b 1
)

cd /d "%~dp0scripts"

echo.
echo ====================================================================
echo Querying Malware Hash: %~1
echo ====================================================================
echo.
echo 2-Step Process:
echo   1. Check EICAR test file (immediate)
echo   2. Query MalwareBazaar API (if enabled)
echo.

python check_hash.py %*

echo.
echo ====================================================================
pause
