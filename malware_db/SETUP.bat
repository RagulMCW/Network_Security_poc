@echo off
REM Initial Setup for Malware Database
REM Downloads databases and installs dependencies

echo ========================================
echo  Malware Database - Initial Setup
echo ========================================
echo.

cd /d "%~dp0"

echo Step 1: Installing Python dependencies...
pip install requests pyyaml tqdm

echo.
echo Step 2: Installing YARA (optional but recommended)...
echo.
echo Note: YARA installation on Windows:
echo   1. Download from: https://github.com/VirusTotal/yara/releases
echo   2. Or install via pip: pip install yara-python
echo.
choice /C YN /M "Install yara-python now"
if errorlevel 2 goto skip_yara
pip install yara-python
:skip_yara

echo.
echo Step 3: Downloading MalwareBazaar hashes (1000 samples)...
cd scripts
python update_malwarebazaar.py --limit 1000

echo.
echo Step 4: Downloading YARA rules...
python update_yara_rules.py

cd ..

echo.
echo Step 5: Creating EICAR test signatures...
echo Already created in hash_databases\eicar_test.txt

echo.
echo ========================================
echo  Setup Complete!
echo ========================================
echo.
echo Database Statistics:
cd scripts
python check_hash.py --stats

echo.
echo ========================================
echo  Quick Start Guide
echo ========================================
echo.
echo Check a file:
echo   CHECK_HASH.bat suspicious_file.exe
echo.
echo Check a hash:
echo   CHECK_HASH.bat 44d88612fea8a8f36de82e1278abb02f
echo.
echo Update databases:
echo   UPDATE_MALWAREBAZAAR.bat
echo   UPDATE_YARA_RULES.bat
echo.
echo View statistics:
echo   CHECK_HASH.bat --stats
echo.

pause
