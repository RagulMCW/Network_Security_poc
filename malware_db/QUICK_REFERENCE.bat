@echo off
REM Quick Reference: Query Malware Hash
REM 2-Step System: EICAR â†’ Local DB â†’ Online API

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo   MALWARE HASH QUERY - Quick Reference
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ğŸ“‹ USAGE:
echo.
echo   CHECK_HASH.bat ^<hash_or_file^> [--online]
echo.
echo ğŸ” EXAMPLES:
echo.
echo   1. Check EICAR test hash (MD5):
echo      CHECK_HASH.bat 44d88612fea8a8f36de82e1278abb02f
echo.
echo   2. Check EICAR test hash (SHA256):
echo      CHECK_HASH.bat 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
echo.
echo   3. Check file:
echo      CHECK_HASH.bat C:\path\to\suspicious.exe
echo.
echo   4. Check hash with MalwareBazaar API:
echo      CHECK_HASH.bat HASH_VALUE --online
echo.
echo âš™ï¸ HOW IT WORKS (2-Step System):
echo.
echo   Step 1: Check if EICAR test file
echo           â†’ If EICAR: Return TEST_FILE (no API call)
echo.
echo   Step 2: Check local databases
echo           â†’ If found: Return MALWARE
echo           â†’ If --online: Query MalwareBazaar API
echo.
echo ğŸ”‘ API KEY (Built-in):
echo   f5b289bbb89ad8a3483fa3548e69d43a7751e16189a2caff
echo.
echo ğŸ“Š DATABASE STATS:
echo   EICAR: 3 signatures (MD5, SHA1, SHA256)
echo   Custom: 4 signatures
echo   MalwareBazaar: 3 signatures
echo.
echo ğŸ¯ CHECK STAGES:
echo   - EICAR_DETECTED    : EICAR found at Step 1 (no API)
echo   - LOCAL_DATABASES   : Checked local DBs only (no API)
echo   - ONLINE_API        : Queried MalwareBazaar API
echo.
echo ğŸš€ QUICK TESTS:
echo.
echo   Test EICAR:    CHECK_HASH.bat 44d88612fea8a8f36de82e1278abb02f
echo   Test Suite:    TEST_HASH_CHECKER.bat
echo   Get Stats:     CHECK_HASH.bat dummy --stats
echo.
echo ğŸ“š DOCUMENTATION:
echo   - QUERY_HASH_GUIDE.md          : Complete usage guide
echo   - IMPLEMENTATION_SUMMARY.md    : Technical details
echo   - README.md                    : Database overview
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

if "%~1"=="" (
    echo âš ï¸  No hash or file provided!
    echo.
    echo Usage: CHECK_HASH.bat ^<hash_or_file^> [--online]
    echo.
    pause
    exit /b 1
)

REM Run the actual check
cd /d "%~dp0scripts"
python check_hash.py %*
pause
