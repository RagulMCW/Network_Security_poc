@echo off
REM Test the 2-step malware hash checker
REM Demonstrates: EICAR detection → Local DB → Online API

echo ========================================
echo Malware Hash Checker - Test Suite
echo ========================================
echo.

cd /d "%~dp0scripts"

echo [TEST 1] EICAR MD5 Hash (Step 1 - Immediate Detection)
echo Hash: 44d88612fea8a8f36de82e1278abb02f
echo Expected: TEST_FILE (no API call)
echo.
python check_hash.py 44d88612fea8a8f36de82e1278abb02f
echo.
echo ----------------------------------------
echo.

echo [TEST 2] EICAR SHA256 Hash (Step 1 - Immediate Detection)
echo Hash: 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
echo Expected: TEST_FILE (no API call)
echo.
python check_hash.py 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
echo.
echo ----------------------------------------
echo.

echo [TEST 3] Unknown Hash (Local DB Only)
echo Hash: 0000000000000000000000000000000000000000000000000000000000000000
echo Expected: CLEAN (no matches in local DB)
echo.
python check_hash.py 0000000000000000000000000000000000000000000000000000000000000000
echo.
echo ----------------------------------------
echo.

echo [TEST 4] Database Statistics
echo.
python check_hash.py --stats
echo.
echo ----------------------------------------
echo.

echo Tests completed!
echo.
echo To test online API (requires 'requests' module):
echo   python check_hash.py HASH_VALUE --online
echo.
pause
