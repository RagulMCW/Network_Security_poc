@echo off
REM Test Malware Hash Query with MalwareBazaar API
REM Demonstrates 2-step checking: EICAR first, then MalwareBazaar API

echo ====================================================================
echo MALWARE HASH QUERY TEST
echo ====================================================================
echo.
echo This script tests the 2-step malware detection system:
echo   Step 1: Check EICAR test file (immediate return)
echo   Step 2: Query MalwareBazaar API with authentication
echo.
echo API Key: f5b289bbb89ad8a3483fa3548e69d43a7751e16189a2caff
echo.

cd /d "%~dp0scripts"

echo ====================================================================
echo TEST 1: EICAR Test File (MD5)
echo ====================================================================
echo Hash: 44d88612fea8a8f36de82e1278abb02f
echo Expected: Should detect as EICAR test file (Step 1)
echo.
python check_hash.py 44d88612fea8a8f36de82e1278abb02f
echo.
pause

echo.
echo ====================================================================
echo TEST 2: EICAR Test File (SHA256)
echo ====================================================================
echo Hash: 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
echo Expected: Should detect as EICAR test file (Step 1)
echo.
python check_hash.py 275a021bbfb6489e54d471899f7db9d1663fc695ec2fe2a2c4538aabf651fd0f
echo.
pause

echo.
echo ====================================================================
echo TEST 3: Known Malware Hash (Online API Query)
echo ====================================================================
echo Hash: 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d
echo Expected: Should query MalwareBazaar API and return malware info
echo.
python check_hash.py 094fd325049b8a9cf6d3e5ef2a6d4cc6a567d7d49c35f8bb8dd9e3c6acf3d78d --online
echo.
pause

echo.
echo ====================================================================
echo TEST 4: Clean Hash (Not Found)
echo ====================================================================
echo Hash: 0000000000000000000000000000000000000000000000000000000000000000
echo Expected: Should check local DB and API, return CLEAN
echo.
python check_hash.py 0000000000000000000000000000000000000000000000000000000000000000 --online
echo.
pause

echo.
echo ====================================================================
echo TEST 5: Check EICAR Test File (File Path)
echo ====================================================================
echo File: test_eicar.txt
echo Expected: Should detect EICAR in file content (Step 1)
echo.
cd ..
python scripts\check_hash.py test_eicar.txt
echo.
pause

echo.
echo ====================================================================
echo All Tests Completed!
echo ====================================================================
echo.
echo Summary:
echo   - Step 1 checks work: EICAR detected immediately
echo   - Step 2 works: MalwareBazaar API queries successful
echo   - API authentication: Using provided API key
echo.
pause
