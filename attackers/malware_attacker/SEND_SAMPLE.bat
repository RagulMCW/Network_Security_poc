@echo off
REM Send real malware sample APK to network monitor for hash-based detection

title Send Malware Sample - Single Shot Transfer

echo.
echo ================================================================
echo    SENDING MALWARE SAMPLE APK (SINGLE SHOT)
echo ================================================================
echo.
echo File:   sample.apk
echo Hash:   945C9508137E5B5CC9FAEDC2A7C19F938968DE30ADB679BAA7D0B6A13E2B83B3
echo Target: 192.168.6.131:5000
echo Mode:   FULL FILE TRANSFER (no chunking)
echo.
echo This will:
echo   1. Send the entire APK file in ONE HTTP POST request
echo   2. Zeek captures the complete binary transfer
echo   3. Zeek extracts the file preserving the hash
echo   4. You can verify hash matches original
echo.

cd /d %~dp0
wsl bash -c "docker exec malware_attacker python3 /app/send_malware_sample.py"

echo.
echo ================================================================
echo Transfer complete!
echo.
echo Expected Hash: 945C9508137E5B5CC9FAEDC2A7C19F938968DE30ADB679BAA7D0B6A13E2B83B3
echo.
echo Next Steps:
echo   1. Check extracted files in zeek_logs
echo   2. Calculate hash of extracted file
echo   3. Verify it matches the expected hash above
echo   4. Run: CHECK_HASH.bat ^<hash^> --online
echo ================================================================
echo.
pause
