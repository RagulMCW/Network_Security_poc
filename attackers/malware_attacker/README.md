# Malware Simulator

Containerized malware behavior simulator for network security testing and IDS validation.

## Overview

This simulator generates various malware-like network behaviors including C2 beaconing, data exfiltration, malicious file uploads, and DNS attacks. It runs in a Docker container and sends traffic to a target endpoint for analysis.

## Features

- C2 Command and Control beaconing (disguised as telemetry)
- Data exfiltration simulation (disguised as cloud sync)
- EICAR test file uploads (disguised as document uploads)
- DNS NXDOMAIN and DGA attacks (using realistic cloud domains)
- **Stealth mode:** Uses legitimate-looking endpoints and user-agents
- **Realistic traffic:** Mimics normal application behavior
- Configurable behavior intervals
- Automatic logging
- Docker containerized

## Requirements

- Docker Desktop with WSL2
- Network named "custom_net" in Docker
- Target endpoint listening on 192.168.6.131:5000

## Quick Start

### Start Simulator

Double-click START.bat or run from command line

Container will build and start automatically.

### Stop Simulator

Double-click STOP.bat or run from command line

### View Logs

Double-click LOGS.bat to view live container logs

### Verify EICAR Detection

Double-click VERIFY_EICAR.bat to check if EICAR is being detected by Zeek

### Live EICAR Monitor

Double-click LIVE_EICAR_MONITOR.bat for real-time detection monitoring

**ðŸ“– See EICAR_DETECTION.md for complete EICAR detection flow and log analysis!**

## Behaviors

### C2 Beacon

Sends periodic beacon messages to simulate command and control communication.

- Interval: 15 seconds (default)
- Method: HTTP POST with session headers
- Data: JSON beacon with timestamp

### Data Exfiltration

Simulates data theft by sending random encrypted data.

- Interval: 25 seconds (default)
- Method: HTTP POST with base64 data
- Size: 1KB - 5KB per transmission

### EICAR Upload

Uploads EICAR test strings to simulate malware file transfers.

- Interval: 40 seconds (default)
- Method: HTTP POST with file metadata
- Content: Standard EICAR test string

### DNS Attacks

Generates NXDOMAIN queries and DGA-like domain lookups.

- Interval: 20 seconds (default)
- Method: DNS queries to non-existent domains
- Pattern: Randomized suspicious domain names

## Configuration

Edit docker-compose.yml to customize behavior intervals:

```yaml
environment:
  - TARGET_IP=192.168.6.131
  - TARGET_PORT=5000
  - C2_BEACON_INTERVAL=15
  - EXFIL_INTERVAL=25
  - EICAR_INTERVAL=40
  - DNS_ATTACK_INTERVAL=20
```

## Architecture

```
Malware Container (192.168.6.200)
    |
    v
malware_simulator.sh
    |
    +-- C2 Beacon (background)
    +-- Data Exfiltration (background)
    +-- EICAR Upload (background)
    +-- DNS Attacks (background)
    |
    v
Target Endpoint (192.168.6.131:5000)
```

## Log Output

Logs are saved to the logs folder with timestamps:

- Behavior activity (C2, EXFIL, EICAR, DNS)
- Success and failure messages
- Status updates every 60 seconds

## Network Details

- Container IP: 192.168.6.200
- Network: custom_net
- Protocol: HTTP/HTTPS and DNS
- Target: 192.168.6.131:5000

## Testing Integration

### With Zeek Monitor

The simulator works with the Zeek network monitor to generate traffic for analysis.

Start Zeek monitor first, then start this simulator to see malicious traffic patterns in Zeek logs.

### With IDS Systems

Traffic patterns are designed to trigger common IDS signatures:

- Suspicious beaconing intervals
- Large data transfers
- Known malware signatures (EICAR)
- DNS tunneling patterns

## Troubleshooting

### Container won't start

Check if custom_net exists:
```
wsl docker network ls | grep custom_net
```

### No traffic generated

Verify target endpoint is running:
```
wsl docker ps
```

Check container logs:
```
LOGS.bat
```

### DNS queries failing

This is expected behavior - NXDOMAIN responses are part of the simulation.

## File Structure

```
malware_attacker/
â”œâ”€â”€ START.bat              - Start simulator
â”œâ”€â”€ STOP.bat               - Stop simulator
â”œâ”€â”€ LOGS.bat               - View logs
â”œâ”€â”€ README.md              - Documentation
â”œâ”€â”€ docker-compose.yml     - Container configuration
â”œâ”€â”€ Dockerfile             - Container image
â”œâ”€â”€ malware_simulator.sh   - Main simulation script
â””â”€â”€ logs/                  - Log output directory
```

## Safety Notes

- This is a SIMULATION for testing purposes only
- EICAR string is a harmless test file
- All traffic stays within Docker network
- No actual malware or exploitation occurs
- Safe for security testing and training

## Performance

- Minimal CPU usage (1-3%)
- Low memory footprint (approximately 50MB)
- Network bandwidth: approximately 10-50 KB/s
- Runs continuously until stopped

## Maintenance

### Clean Logs

Delete files from logs folder manually or use:
```
del /q logs\*
```

### Rebuild Container

```
wsl docker-compose build --no-cache
```

### View Container Status

```
wsl docker ps | grep malware_attacker
```

## Version

1.0 - Initial release with consolidated behaviors and clean architecture

## License

Part of Network Security POC project
